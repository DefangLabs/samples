services:
  db:
    restart: unless-stopped
    image: postgres:16
    environment:
      - POSTGRES_DB=django
      - POSTGRES_USER=django
      - POSTGRES_PASSWORD
    ports:
      - mode: host
        target: 5432

  django:
    restart: unless-stopped
    build: ./app
    ports:
      - mode: ingress
        target: 8000
        published: 8000
    environment:
      - DB_HOST=db
      - DEBUG=False
      - POSTGRES_USER=django
      - POSTGRES_DB=django
      - POSTGRES_PASSWORD
    depends_on:
      - db
